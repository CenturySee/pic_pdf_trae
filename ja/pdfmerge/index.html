<!DOCTYPE html>
<html lang="ja-JP">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFçµåˆãƒ„ãƒ¼ãƒ«</title>
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../../style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
</head>
<body>
    <!-- è¨€èªåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ -->
    <div class="language-switcher">
        <button class="lang-switch-btn" onclick="changeLanguage('zh')">ä¸­æ–‡</button>
        <button class="lang-switch-btn" onclick="changeLanguage('en')">English</button>
        <button class="lang-switch-btn active" onclick="changeLanguage('ja')">æ—¥æœ¬èª</button>
    </div>

    <div class="container">
        <aside class="sidebar">
            <h1>PDFãƒ„ãƒ¼ãƒ«</h1>
            <nav>
                <a href="../pic2pdf/" class="nav-btn">ç”»åƒã‹ã‚‰PDFã¸</a>
                <a href="../pdf2pic/" class="nav-btn">PDFã‹ã‚‰ç”»åƒã¸</a>
                <button class="nav-btn active" data-tab="pdf-merge">PDFçµåˆ</button>
            </nav>
        </aside>
        <main class="main-content">
            <!-- PDFçµåˆ -->
            <section id="pdf-merge" class="tab-content active">
                <div class="section-header">
                    <h2>PDFãƒ•ã‚¡ã‚¤ãƒ«çµåˆ</h2>
                </div>
                
                <!-- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ -->
                <div class="upload-section">
                    <div class="upload-area" id="uploadArea">
                        <input type="file" id="fileInput" accept=".pdf" multiple style="display: none;">
                        <button id="uploadBtn" class="primary-btn">PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</button>
                        <p>ã¾ãŸã¯PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</p>
                        <div class="upload-info">
                            <small>è¤‡æ•°ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã€æš—å·åŒ–PDFãƒ•ã‚¡ã‚¤ãƒ«ã¯çµåˆæ™‚ã«è‡ªå‹•çš„ã«ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™</small>
                        </div>
                    </div>
                </div>

                <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ -->
                <div class="controls-section">
                    <div class="controls-group">
                        <div class="control-item">
                            <label>å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å:</label>
                            <input type="text" id="outputFilename" value="merged.pdf" placeholder="çµåˆå¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›">
                        </div>
                        <div class="control-item">
                            <button class="secondary-btn" onclick="sortByName()">åå‰ã§ã‚½ãƒ¼ãƒˆ</button>
                            <button class="secondary-btn" onclick="sortByTime()">æ™‚é–“ã§ã‚½ãƒ¼ãƒˆ</button>
                        </div>
                        <button id="mergeBtn" class="primary-btn" disabled>PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµåˆ</button>
                    </div>
                </div>

                <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ -->
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-bar" id="progressBar">
                        <div class="progress-fill" id="progressFill"></div>
                        <div class="progress-text" id="progressText">0%</div>
                    </div>
                </div>

                <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ± -->
                <div id="status" class="status-message" style="display: none;"></div>

                <!-- ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ -->
                <div class="preview-section">
                    <div class="preview-header">
                        <h3>PDFãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ</h3>
                        <span id="fileCount" class="file-count">0 å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«</span>
                    </div>
                    <div id="fileList" class="file-list">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“„</div>
                            <p>PDFãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        let uploadedFiles = [];
        let fileIdCounter = 0;

        // DOMè¦ç´ 
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const uploadBtn = document.getElementById('uploadBtn');
        const mergeBtn = document.getElementById('mergeBtn');
        const fileList = document.getElementById('fileList');
        const fileCount = document.getElementById('fileCount');
        const outputFilename = document.getElementById('outputFilename');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const status = document.getElementById('status');

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
        });

        function setupEventListeners() {
            // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
            uploadBtn.addEventListener('click', () => fileInput.click());
            
            // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
            fileInput.addEventListener('change', handleFileSelect);
            
            // ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleDrop);
            
            // çµåˆãƒœã‚¿ãƒ³
            mergeBtn.addEventListener('click', mergePDFs);
        }

        // è¨€èªåˆ‡ã‚Šæ›¿ãˆ
        function changeLanguage(lang) {
            // è¨€èªãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.lang-switch-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ç¾åœ¨ã®ãƒ‘ã‚¹ã‚’å–å¾—
            const path = window.location.pathname;
            
            // æ–°ã—ã„è¨€èªãƒ‘ã‚¹ã‚’æ§‹ç¯‰
            let newPath;
            if (path.includes('/en/')) {
                newPath = path.replace('/en/', `/${lang}/`);
            } else if (path.includes('/zh/')) {
                newPath = path.replace('/zh/', `/${lang}/`);
            } else if (path.includes('/ja/')) {
                newPath = path.replace('/ja/', `/${lang}/`);
            } else {
                // è¨€èªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ãªã„å ´åˆã€è¿½åŠ 
                newPath = `/${lang}/`;
            }
            
            // æ–°ã—ã„ãƒ‘ã‚¹ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
            window.location.href = newPath;
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå‡¦ç†
        async function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            await processFiles(files);
        }

        // ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—å‡¦ç†
        function handleDragOver(event) {
            event.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            uploadArea.classList.remove('dragover');
        }

        async function handleDrop(event) {
            event.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = Array.from(event.dataTransfer.files);
            await processFiles(files);
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        async function processFiles(files) {
            const pdfFiles = files.filter(file => file.type === 'application/pdf');
            
            if (pdfFiles.length === 0) {
                showStatus('PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
                return;
            }

            showStatus('PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºä¸­...', 'info');
            
            // å„PDFãƒ•ã‚¡ã‚¤ãƒ«ã®æš—å·åŒ–çŠ¶æ…‹ã‚’æ¤œå‡º
            for (const file of pdfFiles) {
                try {
                    const arrayBuffer = await file.arrayBuffer();
                    let isEncrypted = false;
                    
                    try {
                        // PDFã®æ­£å¸¸èª­ã¿è¾¼ã¿ã‚’è©¦ã¿ã‚‹
                        await PDFLib.PDFDocument.load(arrayBuffer);
                    } catch (error) {
                        // èª­ã¿è¾¼ã¿å¤±æ•—æ™‚ã€æš—å·åŒ–ã‚¨ãƒ©ãƒ¼ã‚’ãƒã‚§ãƒƒã‚¯
                        if (error.message.includes('encrypted')) {
                            isEncrypted = true;
                        } else {
                            isEncrypted = true;
                        }
                    }

                    const fileObj = {
                        id: fileIdCounter++,
                        file: file,
                        name: file.name,
                        size: file.size,
                        uploadTime: new Date(),
                        isEncrypted: isEncrypted
                    };
                    uploadedFiles.push(fileObj);
                    
                } catch (error) {
                    console.error('PDFãƒ•ã‚¡ã‚¤ãƒ«æ¤œå‡ºã‚¨ãƒ©ãƒ¼:', error);
                    const fileObj = {
                        id: fileIdCounter++,
                        file: file,
                        name: file.name,
                        size: file.size,
                        uploadTime: new Date(),
                        isEncrypted: true
                    };
                    uploadedFiles.push(fileObj);
                }
            }

            updateFileList();
            
            const encryptedCount = uploadedFiles.filter(f => f.isEncrypted).length;
            if (encryptedCount > 0) {
                showStatus(`${pdfFiles.length} å€‹ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸï¼ˆ${encryptedCount} å€‹ãŒæš—å·åŒ–ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰`, 'info');
            } else {
                showStatus(`${pdfFiles.length} å€‹ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸ`, 'success');
            }
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆæ›´æ–°
        function updateFileList() {
            if (uploadedFiles.length === 0) {
                fileList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“„</div>
                        <p>PDFãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„</p>
                    </div>
                `;
                fileCount.textContent = '0 å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«';
                mergeBtn.disabled = true;
                return;
            }

            fileCount.textContent = `${uploadedFiles.length} å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«`;
            mergeBtn.disabled = uploadedFiles.length < 2;

            fileList.innerHTML = uploadedFiles.map((fileObj, index) => `
                <div class="file-item" draggable="true" data-id="${fileObj.id}">
                    <div class="file-info">
                        <div class="file-name">${index + 1}. ${fileObj.name}</div>
                        <div class="file-meta">
                            <span class="file-size">${formatFileSize(fileObj.size)}</span>
                            <span class="file-time">${formatDate(fileObj.uploadTime)}</span>
                            <span class="status-badge ${fileObj.isEncrypted ? 'encrypted' : 'normal'}">
                                ${fileObj.isEncrypted ? 'ğŸ”’ æš—å·åŒ–' : 'âœ… æ­£å¸¸'}
                            </span>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="remove-btn" onclick="removeFile(${fileObj.id})" title="ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤">âœ•</button>
                    </div>
                </div>
            `).join('');

            // ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ã‚½ãƒ¼ãƒˆè¨­å®š
            setupDragAndDrop();
        }

        // ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ã‚½ãƒ¼ãƒˆè¨­å®š
        function setupDragAndDrop() {
            const fileItems = document.querySelectorAll('.file-item');
            let draggedElement = null;

            fileItems.forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    draggedElement = this;
                    this.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                });

                item.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                });

                item.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                });

                item.addEventListener('drop', function(e) {
                    e.preventDefault();
                    if (draggedElement !== this) {
                        const draggedId = parseInt(draggedElement.dataset.id);
                        const targetId = parseInt(this.dataset.id);
                        
                        const draggedIndex = uploadedFiles.findIndex(f => f.id === draggedId);
                        const targetIndex = uploadedFiles.findIndex(f => f.id === targetId);
                        
                        // é…åˆ—ã®å†ã‚½ãƒ¼ãƒˆ
                        const [draggedFile] = uploadedFiles.splice(draggedIndex, 1);
                        uploadedFiles.splice(targetIndex, 0, draggedFile);
                        
                        updateFileList();
                    }
                });
            });
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
        function removeFile(fileId) {
            uploadedFiles = uploadedFiles.filter(file => file.id !== fileId);
            updateFileList();
            showStatus('ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸ', 'info');
        }

        // ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
        function sortByName() {
            uploadedFiles.sort((a, b) => a.name.localeCompare(b.name));
            updateFileList();
            showStatus('åå‰ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸ', 'info');
        }

        function sortByTime() {
            uploadedFiles.sort((a, b) => a.uploadTime - b.uploadTime);
            updateFileList();
            showStatus('ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚é–“ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸ', 'info');
        }

        // PDFãƒ•ã‚¡ã‚¤ãƒ«çµåˆ
        async function mergePDFs() {
            if (uploadedFiles.length < 2) {
                showStatus('çµåˆã™ã‚‹ã«ã¯å°‘ãªãã¨ã‚‚2ã¤ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã™', 'error');
                return;
            }

            // æš—å·åŒ–PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤å¤–
            const normalFiles = uploadedFiles.filter(f => !f.isEncrypted);
            const encryptedFiles = uploadedFiles.filter(f => f.isEncrypted);
            
            if (encryptedFiles.length > 0) {
                showStatus(`${encryptedFiles.length} å€‹ã®æš—å·åŒ–PDFãƒ•ã‚¡ã‚¤ãƒ«ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯è‡ªå‹•çš„ã«ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™`, 'info');
                console.log('ã‚¹ã‚­ãƒƒãƒ—ã•ã‚ŒãŸæš—å·åŒ–ãƒ•ã‚¡ã‚¤ãƒ«:', encryptedFiles.map(f => f.name));
            }

            if (normalFiles.length < 2) {
                showStatus(`é™¤å¤–å¾Œã€æ­£å¸¸ãªPDFãƒ•ã‚¡ã‚¤ãƒ«ã¯ ${normalFiles.length} å€‹ã®ã¿ã§ã™ã€‚çµåˆã™ã‚‹ã«ã¯å°‘ãªãã¨ã‚‚2ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã™`, 'error');
                return;
            }

            const outputFileName = outputFilename.value.trim() || 'merged.pdf';
            
            mergeBtn.disabled = true;
            progressContainer.style.display = 'block';
            showStatus('PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµåˆä¸­...', 'info');

            try {
                const mergedPdf = await PDFLib.PDFDocument.create();
                const totalFiles = normalFiles.length;
                let processedFiles = 0;
                let failedFiles = [];

                for (let i = 0; i < normalFiles.length; i++) {
                    const fileObj = normalFiles[i];
                    
                    try {
                        const arrayBuffer = await fileObj.file.arrayBuffer();
                        const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                        
                        const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                        pages.forEach(page => mergedPdf.addPage(page));
                        processedFiles++;
                        
                    } catch (error) {
                        console.error(`ãƒ•ã‚¡ã‚¤ãƒ« ${fileObj.name} å‡¦ç†ã‚¨ãƒ©ãƒ¼:`, error);
                        failedFiles.push(fileObj.name);
                    }
                    
                    // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
                    const progress = ((i + 1) / totalFiles) * 100;
                    progressFill.style.width = progress + '%';
                    progressText.textContent = Math.round(progress) + '%';
                }

                if (processedFiles === 0) {
                    throw new Error('PDFãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«å‡¦ç†ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ');
                }

                const mergedPdfBytes = await mergedPdf.save();
                
                // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ä½œæˆ
                const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = outputFileName.endsWith('.pdf') ? outputFileName : outputFileName + '.pdf';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                let successMessage = `PDFãƒ•ã‚¡ã‚¤ãƒ«ã®çµåˆãŒå®Œäº†ã—ã¾ã—ãŸï¼ ${a.download} ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸ`;
                if (encryptedFiles.length > 0) {
                    successMessage += `\nã‚¹ã‚­ãƒƒãƒ—ã•ã‚ŒãŸæš—å·åŒ–ãƒ•ã‚¡ã‚¤ãƒ«: ${encryptedFiles.map(f => f.name).join(', ')}`;
                }
                if (failedFiles.length > 0) {
                    successMessage += `\nå‡¦ç†ã«å¤±æ•—ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«: ${failedFiles.join(', ')}`;
                }
                showStatus(successMessage, 'success');
                
            } catch (error) {
                console.error('PDFçµåˆã‚¨ãƒ©ãƒ¼:', error);
                showStatus(`PDFãƒ•ã‚¡ã‚¤ãƒ«ã®çµåˆã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}`, 'error');
            } finally {
                mergeBtn.disabled = false;
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                    progressFill.style.width = '0%';
                    progressText.textContent = '0%';
                }, 2000);
            }
        }

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
        function showStatus(message, type) {
            status.textContent = message;
            status.className = `status-message ${type}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 ãƒã‚¤ãƒˆ';
            const k = 1024;
            const sizes = ['ãƒã‚¤ãƒˆ', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatDate(date) {
            return date.toLocaleString('ja-JP', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
    </script>

    <style>
        /* PDFçµåˆãƒšãƒ¼ã‚¸å›ºæœ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .file-list {
            min-height: 200px;
        }

        .file-item {
            background-color: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            transition: var(--transition);
        }

        .file-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .file-item.dragging {
            opacity: 0.8;
            transform: rotate(3deg) scale(1.05);
            box-shadow: var(--shadow-lg);
            z-index: 10;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .file-meta {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .file-size {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .file-time {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .file-actions {
            display: flex;
            gap: 0.5rem;
        }

        .remove-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 1.2rem;
            transition: var(--transition);
        }

        .remove-btn:hover {
            color: #ef4444;
            background-color: #fef2f2;
        }

        .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-badge.normal {
            background-color: #dcfce7;
            color: #166534;
        }

        .status-badge.encrypted {
            background-color: #fef3c7;
            color: #92400e;
        }

        .dragover {
            border: 2px dashed var(--primary-color);
            background-color: #f0f9ff;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary);
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .file-count {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .upload-info {
            margin-top: 0.5rem;
            color: var(--text-secondary);
        }

        .upload-info small {
            font-size: 0.75rem;
        }
    </style>
    <script src="script.js"></script>
</body>
</html>